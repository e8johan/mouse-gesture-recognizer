I have started to implement support for diagonal movements, but the simplify function will need more work.